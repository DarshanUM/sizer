apiVersion: "v1"
kind: "DeploymentConfig"
metadata:
  name: "mysqldbstg"
  labels:
    app: "mysqldbstg"
spec:
  template:
    metadata:
      labels:
        name: "mysqldbstg"
        deploymentconfig: "mysqldbstg"
      annotations:
        app_version: 'latest'
    spec:
      volumes:
        - name: "pvol"
          persistentVolumeClaim:
            claimName: "dbstg"
      containers:
        - name: "mysqldbstg"
          image: "containers.cisco.com/aws_managed/mysql-5.7"
          ports:
            - 
              containerPort: 3306
              protocol: "TCP"
          env:
            - name: "MYSQL_DATABASE"
              value: "sizerstg"
            - name: "MYSQL_PASSWORD"
              value: "39Xn7h-mayJF"
            - name: "MYSQL_USER"
              value: "adminX1WERfE"
            - name: "APP_NAME"
              value: "mysqldbstg"
          resources:
              limits:
                  memory: 2Gi
              requests:
                  cpu: 100m
          volumeMounts:
            - name: "pvol"
              mountPath: "/var/lib/mysql/data"
          terminationMessagePath: /dev/termination-log
          imagePullPolicy: Always
      restartPolicy: Always
      terminationGracePeriodSeconds: 30
      dnsPolicy: ClusterFirst
      securityContext: {}
    dnsPolicy: "ClusterFirst"
  replicas: 1
  selector:
    name: "mysqldbstg"
  triggers:
    -
      type: "ConfigChange"
  strategy:
    type: "Rolling"
    rollingParams:
      updatePeriodSeconds: 1
      intervalSeconds: 1
      timeoutSeconds: 120
